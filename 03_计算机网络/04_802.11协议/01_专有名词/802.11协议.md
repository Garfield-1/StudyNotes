# 802.11协议

`802.11`协议是由`IEEE`（电气和电子工程师协会）制定的一系列无线局域网（`WLAN`）标准的总称。它定义了无线网络通信的技术规范，广泛应用于`Wi-Fi`网络。以下是一些主要的`802.11`标准：

1. **802.11a**：工作在`5 GHz`频段，最大传输速率为`54 Mbps`
2. **802.11b**：工作在`2.4 GHz`频段，最大传输速率为`11 Mbps`
3. **802.11g**：工作在`2.4 GHz`频段，最大传输速率为`54 Mbps`，向下兼容`802.11b`
4. **802.11n**：工作在`2.4 GHz`和`5 GHz`频段，最大传输速率可达`600 Mbps`，引入了`MIMO`（多输入多输出）技术
5. **802.11ac**：主要工作在`5 GHz`频段，最大传输速率可达1 Gbps以上，进一步提升了`MIMO`技术
6. **802.11ax（Wi-Fi 6）**：工作在`2.4 GHz`和`5 GHz`频段，最大传输速率可达`10 Gbps`，提升了网络效率和设备容量

这些标准不断发展，旨在提高无线网络的速度、覆盖范围和可靠性。`802.11`协议广泛应用于家庭、企业和公共场所的无线网络连接，详情可见官网https://standards.ieee.org/access-standards/



## 术语

### 1. **WAN**（`Wide Area Network`即广域网）

覆盖范围较大的计算机网络。它可以连接多个地理位置分散的局域网（LAN），使得不同区域的设备能够互相通信



### 2. **LAN**（`Local Area Network`即局域网）

覆盖范围较小的计算机网络，通常用于连接同一建筑物或局部区域内的设备，例如家庭、办公室或学校的网络



### 3. **WLAN**（ `Wireless Local Area Network`即无线局域网）

通过无线通信技术（如 Wi-Fi）实现的局域网（LAN）。它允许设备在没有物理网线连接的情况下，通过无线信号进行通信和数据传输，`WLAN` 使用 `802.11` 系列标准（如 `802.11n`、`802.11ac`、`802.11ax`）进行通信



### 4. **VLAN**（`Virtual Local Area Network`即虚拟局域网）

通过逻辑划分网络的方法，用于在同一个物理网络设备（如交换机）上创建多个独立的虚拟网络



### 5. **AP**（`Access point`即无线接入点）

`AP`指无线接入点，是一个无线网络的接入点，俗称“热点”。是一个无线网络中的特殊节点，通过这个节点，无线网络中的其它类型节点可以和无线网络外部以及内部进行通信。主要有路由交换接入一体设备和纯接入点设备，一体设备执行接入和路由工作，纯接入设备只负责无线客户端的接入。纯接入设备通常作为无线网络扩展使用，与其他`AP`或者主`AP`连接，以扩大无线覆盖范围，而一体设备一般是无线网络的核心



### 6. **STA**（`station`即终端设备）

表示连接到无线网络中的设备，这些设备通过`AP`，可以和内部其它设备或者无线网络外部通信



### 7. **SSID**（`Service Set Identifier`即服务集标识符）

它是一个无线网络的名称，用于标识特定的无线局域网（`WLAN`）



### 8. **BSS**（`Basic Service Set`即基本服务集）

无线局域网（`WLAN`）的基本构建单元。它定义了一组无线设备通过无线通信形成的网络

1. **`BSS`的组成**

   * **无线接入点（AP）**

     - 在基础设施模式下，`BSS` 通常由一个无线接入点（`AP`）和与其通信的无线客户端设备组成

     - `AP` 是 `BSS` 的中心节点，负责管理无线设备的连接和通信

   * **无线客户端设备（STA）**
     - 包括笔记本电脑、智能手机、平板电脑等支持无线通信的设备
     - 这些设备通过 `AP` 或直接相互通信

   * **BSSID**
     - 每个 `BSS` 都有一个唯一的标识符，称为 `BSSID`，通常是 `AP` 的 `MAC` 地址

2. **`BSS`的类型**

   * **独立BSS（IBSS，Independent Basic Service Set）**

     - 也称为 **Ad-hoc 网络**

     - 不需要无线接入点，设备之间直接通信

     - 适用于临时网络，例如点对点文件共享

   * **基础设施BSS（Infrastructure Basic Service Set）**

     - 包括一个无线接入点（`AP`）和与其通信的无线设备

     - 无线设备通过 `AP` 进行通信，`AP` 也可以连接到有线网络，从而实现无线设备与有线网络的互通

     - 这是最常见的 `BSS` 类型，广泛用于家庭、办公室和公共场所的无线网络

3. **`BSS`的作用**

   * **定义无线网络的范围**

     - `BSS` 的覆盖范围由 `AP` 的无线信号决定，通常称为 **BSS范围**

     - 设备必须在 `BSS` 的范围内才能连接到网络

   * **管理无线通信**：
     - `AP` 负责管理 `BSS` 内的设备，包括认证、关联和数据传输

4. **支持漫游**：
   - 在多个 `BSS` 组成的网络中（如企业 `WLAN`），设备可以在不同的 `BSS` 之间切换（漫游），保持网络连接



### 8. **BSSID**（`Basic Service Set Identifier`即基本服务集标识符）

用于唯一标识一个无线接入点（`AP`）或无线网络中的一个基本服务集（`BSS`）

1. **BSSID**的定义

   - **BSSID** 是一个 48 位的标识符，通常是无线接入点（`AP`）的 `MAC` 地址

   - 它用于区分同一物理区域内的多个无线网络，即使它们的 `SSID`（网络名称）相同

2. **BSSID的作用**

   * **唯一标识无线网络**：

     - 每个 `BSS`（`Basic Service Set`，基本服务集）都有一个唯一的 `BSSID`

     - 即使多个接入点广播相同的 `SSID`（例如在企业网络中），它们的 `BSSID` 仍然是唯一的

   * **设备连接的目标**：
     - 当无线客户端设备（如手机或笔记本电脑）连接到一个无线网络时，它实际上是连接到一个特定的 `BSSID`，而不是仅仅通过 `SSID`

   * **支持漫游**：
     - 在支持漫游的网络中（如企业 `WLAN`），`BSSID` 帮助客户端设备识别和切换到信号更强的接入点

3. **`BSSID`的格式**

   - `BSSID` 通常是无线接入点的 `MAC` 地址

   - 格式为 `6` 字节（`48` 位），例如：`00:14:22:01:23:45`

4. **`BSSID`与`SSID`的区别**

   | 特性       | BSSID                         | SSID                            |
   | ---------- | ----------------------------- | ------------------------------- |
   | **含义**   | 标识一个具体的无线接入点      | 标识无线网络的名称              |
   | **唯一性** | 每个接入点的 `BSSID` 是唯一的 | 多个接入点可以共享相同的 `SSID` |
   | **作用**   | 用于设备连接到特定的接入点    | 用于用户识别和选择网络          |
   | **格式**   | `48` 位 `MAC` 地址            | 最多 `32` 个字符的字符串        |



### 9. **BRIDGE**（**网桥**）

**Bridge（网桥）** 是一种工作在数据链路层的网络设备，用于连接网络段、转发数据帧和减少冲突域。虽然现代网络中交换机已逐渐取代了网桥，但网桥仍然在某些特定场景（如小型网络或无线桥接）中发挥作用



### 10. **WPA**（`Wi-Fi Protected Access`即`Wi-Fi`保护访问）

用于保护无线网络安全的加密协议。它由 `Wi-Fi` 联盟开发，用于解决早期无线网络加密协议 **WEP（Wired Equivalent Privacy）** 的安全漏洞问题

1. **WPA的特点**

   * **增强的安全性**：
     - 相比 `WEP`，`WPA` 提供了更强的加密和认证机制，显著提高了无线网络的安全性

   * **动态密钥管理**：
     - `WPA` 使用动态密钥生成机制，定期更换加密密钥，防止攻击者通过捕获数据包破解密钥

   * **兼容性**：
     - `WPA` 设计时考虑了与旧设备的兼容性，因此许多支持 `WEP` 的设备可以通过固件升级支持 `WPA`

2. **WPA的版本**

   * **WPA（WPA1）**：

     - 引入于 `2003` 年，作为 `WEP` 的替代方案

     - 使用 **TKIP（Temporal Key Integrity Protocol）** 作为加密算法

     - `TKIP` 动态生成加密密钥，并为每个数据包分配唯一的密钥

     - 虽然比 WEP 安全，但仍存在一些已知漏洞，因此 `WPA1` 已逐渐被淘汰

   * **WPA2**：

     - 引入于 `2004` 年，是 `WPA` 的改进版本，也是目前最常用的无线网络安全协议

     - 使用 **AES（Advanced Encryption Standard）** 作为加密算法，提供更强的安全性

     - 支持 **CCMP（Counter Mode with Cipher Block Chaining Message Authentication Code Protocol）**，进一步增强数据完整性和保密性

     - `WPA2` 是 `Wi`-Fi 联盟的强制认证标准

   * **WPA3**：

     - 引入于 `2018` 年，是 `WPA2` 的升级版本，旨在应对现代安全威胁。

     - 提供以下改进：
       - **更强的加密**：使用 `192` 位加密密钥（企业模式）。
       - **防止离线攻击**：引入 **SAE（Simultaneous Authentication of Equals）**协议，防止攻击者通过捕获握手数据进行离线暴力破解
       - **个性化加密**：为每个设备提供独立的加密密钥，增强公共 `Wi-Fi` 的安全性

3. **WPA的工作原理**

   * **认证**：
     - 使用预共享密钥（`PSK`，`Pre-Shared Key`）或企业级认证（如 `RADIUS` 服务器）验证用户身份

   * **加密**：
     - `WPA` 使用 `TKIP` 或 `AES` 对无线通信数据进行加密，确保数据在传输过程中不会被窃听或篡改

   * **动态密钥更新**：
     - `WPA` 定期更新加密密钥，防止攻击者通过捕获大量数据包破解密钥

4. **WPA的模式**

   * **WPA-Personal（WPA-PSK）**：

     - 使用预共享密钥（`PSK`）进行认证

     - 适用于家庭和小型办公室网络

   * **WPA-Enterprise**：

     - 使用 `802.1X` 和 `RADIUS` 服务器进行认证

     - 适用于企业网络，提供更高的安全性和灵活性

5. **WPA与其他协议的对比**

   | 特性         | WEP            | WPA               | WPA2              | WPA3              |
   | ------------ | -------------- | ----------------- | ----------------- | ----------------- |
   | **加密算法** | `RC4`          | `TKIP`            | `AES`             | `AES`             |
   | **安全性**   | 弱（易被破解） | 中（已过时）      | 强（广泛使用）    | 更强（最新标准）  |
   | **动态密钥** | 不支持         | 支持              | 支持              | 支持              |
   | **认证方式** | 静态密钥       | `PSK` 或 `802.1X` | `PSK` 或 `802.1X` | `SAE` 或 `802.1X` |



### 11. **RKH**（`R0 Key Holder`即`R0`密钥持有者）

`RKH`是无线网络安全和快速漫游相关的一个概念，主要用于支持设备在不同接入点（`AP`）之间快速切换时的密钥管理

1. **RKH的背景**

   在无线网络中，设备（如手机或笔记本电脑）在不同接入点之间漫游时，通常需要重新进行认证和密钥协商。这可能导致延迟，影响用户体验。为了减少这种延迟，`802.11r`（`Fast BSS Transition`，快速基本服务集切换）协议引入了分层密钥管理机制，其中 **RKH** 是关键角色之一

2. **RKH的作用**

   * **密钥管理**：

     - `RKH` 是负责存储和管理 **PMK-R0（Pairwise Master Key-R0）** 的实体

     - 它是密钥分发的中心，确保漫游时快速生成新的密钥

   * **支持快速漫游**：
     - 当设备从一个接入点切换到另一个接入点时，`RKH` 提供必要的密钥信息，避免重新与认证服务器（如 `RADIUS`）通信，从而加快漫游过程

   * **分层密钥结构**：
     - `RKH` 是分层密钥管理架构的一部分
       - **PMK-R0**：由 `RKH` 管理，用于生成 `PMK-R1`
       - **PMK-R1**：由目标接入点（`AP`）管理，用于生成会话密钥（如 `PTK`）

3. **RKH的工作流程**

   以下是 `RKH` 在快速漫游中的大致工作流程：

   * **初始认证**：

     - 设备首次连接到网络时，通过完整的 802.1X 认证过程生成主密钥（`PMK`）

     - `RKH` 负责存储 PMK 并生成 `PMK-R0`

   * **密钥分发**：
     - `RKH` 将 `PMK-R1` 分发给可能成为漫游目标的接入点
   * **快速切换**：
     - 当设备漫游到新的接入点时，新的接入点使用 `PMK-R1` 快速生成会话密钥（`PTK`），完成漫游过程

4. **RKH的优势**

   * **减少漫游延迟**：
     - 通过预先分发密钥，设备可以快速切换到新的接入点，而无需重新认证

   * **提高用户体验**：
     - 特别是在语音通话或视频会议等对延迟敏感的应用中，RKH 的快速漫游支持显著提高了用户体验

   * **增强安全性**：
     - 使用分层密钥结构，确保密钥的安全性和独立性

5. **相关协议**

   - **802.11r（Fast BSS Transition）**：定义了快速漫游的机制，`RKH` 是其中的重要组成部分

   - **PMK-R0 和 PMK-R1**：`RKH` 负责管理这些密钥，用于支持分层密钥结构



### 12. **HS20**（`Hotspot 2.0`）

**HS20** 是由 **Wi-Fi Alliance** 推出的一个无线网络技术标准，旨在简化用户在公共 `Wi-Fi` 热点之间的连接过程，同时提高安全性和用户体验

1. **HS20**的背景

   传统的公共 `Wi-Fi` 热点通常需要用户手动选择网络并输入密码，这种方式不仅繁琐，还可能存在安全隐患。**Hotspot 2.0** 通过自动化和安全的连接机制，解决了这些问题

2. **HS20**的主要特点
   1. **自动连接**：
      - 用户设备可以根据预先配置的凭据（如 `SIM` 卡、证书或用户名/密码）自动连接到支持 `HS20` 的热点，无需手动选择网络或输入密码
   2. **增强的安全性**：
      - 使用 `WPA2-Enterprise` 或 `WPA3-Enterprise` 加密协议，确保数据传输的安全性
      - 支持 `802.1X` 认证，提供更强的用户身份验证
   3. **无缝漫游**：
      - 支持设备在不同的热点之间无缝切换，类似于蜂窝网络的漫游体验
      - 适用于运营商之间的 `Wi-Fi` 漫游协议
   4. **网络发现与选择**：
      - 设备可以根据运营商、服务提供商或用户偏好，自动选择最合适的热点
   5. **支持多种认证方式**：
      - 包括 `SIM` 卡认证（`EAP-SIM`）、证书认证（`EAP-TLS`）和用户名/密码认证（`EAP-TTLS`、`PEAP`）



### 13. **DPP**（`Device Provisioning Protocol`即设备配置协议）

是由 `Wi-Fi` 联盟推出的一种协议，旨在简化 `Wi-Fi` 设备的配置和连接过程，同时提高安全性。`DPP` 通常被称为 `Wi-Fi Easy Connect`，是传统 `WPS`的替代方案

1. **DPP的主要特点**

   * **简化设备配置**：

   - `DPP` 允许用户通过简单的方式（如扫描二维码或 `NFC`）将设备安全地连接到 `Wi-Fi` 网络，而无需手动输入 `SSID` 和密码

   * **增强的安全性**：

     - 使用现代加密技术（如公钥加密）代替传统的共享密码，避免了密码泄露的风险

     - 消除了 `WPS` 中已知的安全漏洞

   * **支持多种设备**：
     - `DPP` 适用于各种类型的设备，包括智能家居设备（如智能灯、摄像头）、物联网设备（`IoT`）以及传统的 `Wi-Fi` 设备

   * **无需共享密码**：
     - 配置设备时，用户无需直接共享 `Wi-Fi` 密码，`DPP` 会通过安全的密钥交换机制完成配置

2. **DPP的工作原理**

   `DPP` 的核心是基于公钥加密的安全配置流程，主要包括以下步骤：

   1. **引导（Bootstrapping）**：
      - 用户通过扫描二维码、`NFC` 或其他方式，将设备的公钥传递给配置设备（如手机或路由器）
      - 二维码中包含设备的公钥和其他必要信息
   2. **认证（Authentication）**：
      - 配置设备和目标设备通过公钥加密进行相互认证，确保通信的安全性
   3. **网络配置（Provisioning）**：
      - 配置设备将 `Wi-Fi` 网络的相关信息（如 `SSID` 和加密密钥）通过安全通道发送给目标设备
      - 目标设备使用这些信息连接到 Wi-Fi 网络
   4. **连接（Connection）**：
      - 目标设备完成配置后，自动连接到指定的 `Wi-Fi` 网络

3. **DPP的优势**

   * **更高的安全性**：

     - 使用公钥加密，避免了传统密码的暴露风险

     - 消除了 `WPS` 的安全漏洞（如 `PIN` 攻击）

   * **适用于物联网设备**：
     * `DPP` 特别适合没有屏幕或输入界面的 `IoT` 设备（如智能灯泡、传感器）

   * **灵活性**：
     - 支持多种引导方式（二维码、`NFC`、蓝牙等），适应不同场景

4. **DPP与WPS的对比**

   | 性           | DPP（Device Provisioning Protocol） | WPS（Wi-Fi Protected Setup） |
   | ------------ | ----------------------------------- | ---------------------------- |
   | **安全性**   | 高（使用公钥加密）                  | 较低（存在已知漏洞）         |
   | **配置方式** | 二维码、`NFC`、蓝牙等               | 按按钮或输入 `PIN`           |
   | **密码暴露** | 不需要共享密码                      | 需要共享密码                 |
   | **适用设备** | 适合 `IoT` 和智能设备               | 主要适用于传统 `Wi-Fi` 设备  |
   | **用户体验** | 简单、现代化                        | 较为繁琐                     |



### 14. **MACSEC**（`Media Access Control Security`即媒体访问控制安全）

`MACSEC`是一种基于链路层（`OSI` 模型的第 `2` 层）的安全协议，用于保护以太网通信的完整性和机密性。它由 `IEEE 802.1AE` 标准定义，主要用于防止链路层的安全威胁，如窃听、篡改和重放攻击



### 15. **MKA**（`MACsec Key Agreement`即`MACsec`密钥协商）

`MKA`是 `IEEE 802.1X` 标准的一部分，用于支持 **MACsec（Media Access Control Security）** 的密钥管理和分发。`MKA` 协议的主要作用是协商和管理加密密钥，以便在使用 MACsec 的设备之间建立安全通信